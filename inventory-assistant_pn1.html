<html lang="en-CA" data-critters-container="">
<head>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Project Assistant | Inventory Assistant</title>
<!--base href="./"-->
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/x-icon" href="img/favicon-pa.ico">
<meta name="robots" content="noindex, nofollow">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous">
<style>
@font-face {
    font-family: 'Lato';
    font-style: normal;
    font-weight: 400;
    src: url(https://fonts.gstatic.com/s/lato/v24/S6uyw4BMUTPHjxAwXjeu.woff2) format('woff2');
unicode-range:U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
    font-family: 'Lato';
    font-style: normal;
    font-weight: 400;
    src: url(https://fonts.gstatic.com/s/lato/v24/S6uyw4BMUTPHjx4wXg.woff2) format('woff2');
unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9X6VLKzA.woff2) format('woff2');
unicode-range:U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9e6VLKzA.woff2) format('woff2');
unicode-range:U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9b6VLKzA.woff2) format('woff2');
unicode-range:U+0900-097F, U+1CD0-1CF9, U+200C-200D, U+20A8, U+20B9, U+20F0, U+25CC, U+A830-A839, U+A8E0-A8FF, U+11B00-11B09;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9W6VLKzA.woff2) format('woff2');
unicode-range:U+1F00-1FFF;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9Z6VLKzA.woff2) format('woff2');
unicode-range:U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9V6VLKzA.woff2) format('woff2');
unicode-range:U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9U6VLKzA.woff2) format('woff2');
unicode-range:U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
    font-family: 'Noto Sans';
    font-style: normal;
    font-weight: 400;
    font-stretch: 100%;
    src: url(https://fonts.gstatic.com/s/notosans/v38/o-0mIpQlx3QUlC5A4PNB6Ryti20_6n1iPHjcz6L1SoM-jCpoiyD9A-9a6VI.woff2) format('woff2');
unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
</style>
<style>
@font-face{font-family:'Material Icons';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/materialicons/v142/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2) format('woff2');}.material-icons{font-family:'Material Icons';font-weight:normal;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:'liga';-webkit-font-smoothing:antialiased;}
</style>
<style>
@font-face{font-family:'Material Icons Outlined';font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/materialiconsoutlined/v109/gok-H7zzDkdnRel8-DQ6KAXJ69wP1tGnf4ZGhUce.woff2) format('woff2');}.material-icons-outlined{font-family:'Material Icons Outlined';font-weight:normal;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:'liga';-webkit-font-smoothing:antialiased;}
</style>
<style>
@charset "UTF-8";:root{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-primary:#0d6efd;--bs-secondary:#6c757d;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-font-sans-serif:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--bs-gradient:linear-gradient(180deg, rgba(255, 255, 255, .15), rgba(255, 255, 255, 0))}*,:after,:before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:var(--bs-font-sans-serif);font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}@-webkit-keyframes progress-bar-stripes{0%{background-position-x:1rem}}@-webkit-keyframes spinner-border{to{transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{transform:scale(0)}50%{opacity:1;transform:none}}:root{--header-height:3rem;--nav-width:80px;--first-color:#1b1c1e;--first-color-light:#efefef;--white-color:#333;--body-font:"Noto Sans", sans-serif;--z-fixed:100}*,:before,:after{box-sizing:border-box}body{background-color:#f8f9f8;color:#333;position:relative;margin:var(--header-height) 0 0 0;padding:0 1rem;font-family:var(--body-font);transition:.5s}.body-pd{padding-left:calc(var(--nav-width) + 1rem)}@media screen and (min-width: 768px){body{margin:calc(var(--header-height) + 1rem) 0 0 0;padding-left:calc(var(--nav-width) + 2rem)}.body-pd{padding-left:calc(var(--nav-width) + 178px)}}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}:root{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol;--font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";--surface-a:#ffffff;--surface-b:#f8f9fa;--surface-c:#e9ecef;--surface-d:#dee2e6;--surface-e:#ffffff;--surface-f:#ffffff;--text-color:#495057;--text-color-secondary:#6c757d;--primary-color:#2196F3;--primary-color-text:#ffffff;--surface-0:#ffffff;--surface-50:#fafafa;--surface-100:#f5f5f5;--surface-200:#eeeeee;--surface-300:#e0e0e0;--surface-400:#bdbdbd;--surface-500:#9e9e9e;--surface-600:#757575;--surface-700:#616161;--surface-800:#424242;--surface-900:#212121;--gray-50:#fafafa;--gray-100:#f5f5f5;--gray-200:#eeeeee;--gray-300:#e0e0e0;--gray-400:#bdbdbd;--gray-500:#9e9e9e;--gray-600:#757575;--gray-700:#616161;--gray-800:#424242;--gray-900:#212121;--content-padding:1rem;--inline-spacing:.5rem;--border-radius:3px;--surface-ground:#f8f9fa;--surface-section:#ffffff;--surface-card:#ffffff;--surface-overlay:#ffffff;--surface-border:#dee2e6;--surface-hover:#e9ecef;--maskbg:rgba(0, 0, 0, .4);--highlight-bg:#E3F2FD;--highlight-text-color:#495057;--focus-ring:0 0 0 .2rem #a6d5fa;color-scheme:light}:root{--blue-50:#f4fafe;--blue-100:#cae6fc;--blue-200:#a0d2fa;--blue-300:#75bef8;--blue-400:#4baaf5;--blue-500:#2196f3;--blue-600:#1c80cf;--blue-700:#1769aa;--blue-800:#125386;--blue-900:#0d3c61;--green-50:#f6fbf6;--green-100:#d4ecd5;--green-200:#b2ddb4;--green-300:#90cd93;--green-400:#6ebe71;--green-500:#4caf50;--green-600:#419544;--green-700:#357b38;--green-800:#2a602c;--green-900:#1e4620;--yellow-50:#fffcf5;--yellow-100:#fef0cd;--yellow-200:#fde4a5;--yellow-300:#fdd87d;--yellow-400:#fccc55;--yellow-500:#fbc02d;--yellow-600:#d5a326;--yellow-700:#b08620;--yellow-800:#8a6a19;--yellow-900:#644d12;--cyan-50:#f2fcfd;--cyan-100:#c2eff5;--cyan-200:#91e2ed;--cyan-300:#61d5e4;--cyan-400:#30c9dc;--cyan-500:#00bcd4;--cyan-600:#00a0b4;--cyan-700:#008494;--cyan-800:#006775;--cyan-900:#004b55;--pink-50:#fef4f7;--pink-100:#fac9da;--pink-200:#f69ebc;--pink-300:#f1749e;--pink-400:#ed4981;--pink-500:#e91e63;--pink-600:#c61a54;--pink-700:#a31545;--pink-800:#801136;--pink-900:#5d0c28;--indigo-50:#f5f6fb;--indigo-100:#d1d5ed;--indigo-200:#acb4df;--indigo-300:#8893d1;--indigo-400:#6372c3;--indigo-500:#3f51b5;--indigo-600:#36459a;--indigo-700:#2c397f;--indigo-800:#232d64;--indigo-900:#192048;--teal-50:#f2faf9;--teal-100:#c2e6e2;--teal-200:#91d2cc;--teal-300:#61beb5;--teal-400:#30aa9f;--teal-500:#009688;--teal-600:#008074;--teal-700:#00695f;--teal-800:#00534b;--teal-900:#003c36;--orange-50:#fff8f2;--orange-100:#fde0c2;--orange-200:#fbc791;--orange-300:#f9ae61;--orange-400:#f79530;--orange-500:#f57c00;--orange-600:#d06900;--orange-700:#ac5700;--orange-800:#874400;--orange-900:#623200;--bluegray-50:#f7f9f9;--bluegray-100:#d9e0e3;--bluegray-200:#bbc7cd;--bluegray-300:#9caeb7;--bluegray-400:#7e96a1;--bluegray-500:#607d8b;--bluegray-600:#526a76;--bluegray-700:#435861;--bluegray-800:#35454c;--bluegray-900:#263238;--purple-50:#faf4fb;--purple-100:#e7cbec;--purple-200:#d4a2dd;--purple-300:#c279ce;--purple-400:#af50bf;--purple-500:#9c27b0;--purple-600:#852196;--purple-700:#6d1b7b;--purple-800:#561561;--purple-900:#3e1046;--red-50:#fff5f5;--red-100:#ffd1ce;--red-200:#ffada7;--red-300:#ff8980;--red-400:#ff6459;--red-500:#ff4032;--red-600:#d9362b;--red-700:#b32d23;--red-800:#8c231c;--red-900:#661a14;--primary-50:#f4fafe;--primary-100:#cae6fc;--primary-200:#a0d2fa;--primary-300:#75bef8;--primary-400:#4baaf5;--primary-500:#2196f3;--primary-600:#1c80cf;--primary-700:#1769aa;--primary-800:#125386;--primary-900:#0d3c61}@layer primeng{*{box-sizing:border-box}}@layer primeng{@-webkit-keyframes p-fadein{0%{opacity:0}to{opacity:1}}}@-webkit-keyframes p-icon-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}
</style>
<link rel="stylesheet" href="css/UPD-styles.css" media="all" onload="this.media='all'">
<link rel="stylesheet" href="css/ca-styles.css" media="all" onload="this.media='all'">
<link rel="stylesheet" href="css/pa-styles.css" media="all" onload="this.media='all'">
<link rel="stylesheet" href="css/prism.css" data-noprefix />
<noscript>
<link rel="stylesheet" href="css/UPD-styles.css">
<link rel="stylesheet" href="css/ca-styles.css" media="all" onload="this.media='all'">
<link rel="stylesheet" href="css/pa-styles.css" media="all" onload="this.media='all'">
</noscript>
<script async=""></script>
<style>
main[_ngcontent-ng-c3392822675]{position:relative}
</style>
<style>
.language-picker-area[_ngcontent-ng-c3122493551]{display:flex;justify-content:flex-end}.picker-label[_ngcontent-ng-c3122493551]{margin-right:20px}.language-picker[_ngcontent-ng-c3122493551]{width:100px}.langs[_ngcontent-ng-c3122493551], .langs[_ngcontent-ng-c3122493551]:hover, .langs[_ngcontent-ng-c3122493551]:visited{text-decoration:underline;color:#2e5ea7}
</style>
<style>
#menu-custom-report-label.col[_ngcontent-ng-c82967845]{flex:0 0 0%!important;flex-grow:0!important}a.cr-link[_ngcontent-ng-c82967845] > .row[_ngcontent-ng-c82967845] > .col[_ngcontent-ng-c82967845]:nth-child(2){flex-grow:0!important}a.cr-link[_ngcontent-ng-c82967845] > .row[_ngcontent-ng-c82967845] > .col[_ngcontent-ng-c82967845]:nth-child(1){flex:0 0 0%!important;flex-grow:0!important}
</style>
<style>
.bg-green[_ngcontent-ng-c2697168388]{background-color:#90ee90!important}td.validation-kpi-not-met[_ngcontent-ng-c2697168388] + td.bg-green[_ngcontent-ng-c2697168388]{background-color:#f8e6d2!important}.exportButtons[_ngcontent-ng-c2697168388]{margin:0 5px 5px 0}
</style>
<style>
@layer primeng{.p-datatable{position:relative}.p-datatable>.p-datatable-wrapper{overflow:auto}.p-datatable-table{border-spacing:0px;width:100%}.p-datatable .p-sortable-column{cursor:pointer;-webkit-user-select:none;user-select:none}.p-datatable .p-sortable-column .p-column-title,.p-datatable .p-sortable-column .p-sortable-column-icon,.p-datatable .p-sortable-column .p-sortable-column-badge{vertical-align:middle}.p-datatable .p-sortable-column .p-icon-wrapper{display:inline}.p-datatable .p-sortable-column .p-sortable-column-badge{display:inline-flex;align-items:center;justify-content:center}.p-datatable-hoverable-rows .p-selectable-row{cursor:pointer}.p-datatable-scrollable>.p-datatable-wrapper{position:relative}.p-datatable-scrollable-table>.p-datatable-thead{position:sticky;top:0;z-index:2}.p-datatable-scrollable-table>.p-datatable-frozen-tbody{position:sticky;z-index:1}.p-datatable-scrollable-table>.p-datatable-tfoot{position:sticky;bottom:0;z-index:1}.p-datatable-scrollable .p-frozen-column{position:sticky;background:inherit;z-index:1}.p-datatable-scrollable th.p-frozen-column{z-index:1}.p-datatable-flex-scrollable{display:flex;flex-direction:column;height:100%}.p-datatable-flex-scrollable>.p-datatable-wrapper{display:flex;flex-direction:column;flex:1;height:100%}.p-datatable-scrollable-table>.p-datatable-tbody>.p-rowgroup-header{position:sticky;z-index:2}.p-datatable-resizable-table>.p-datatable-thead>tr>th,.p-datatable-resizable-table>.p-datatable-tfoot>tr>td,.p-datatable-resizable-table>.p-datatable-tbody>tr>td{overflow:hidden;white-space:nowrap}.p-datatable-resizable-table>.p-datatable-thead>tr>th.p-resizable-column:not(.p-frozen-column){background-clip:padding-box;position:relative}.p-datatable-resizable-table-fit>.p-datatable-thead>tr>th.p-resizable-column:last-child .p-column-resizer{display:none}.p-datatable .p-column-resizer{display:block;position:absolute!important;top:0;right:0;margin:0;width:.5rem;height:100%;padding:0;cursor:col-resize;border:1px solid transparent}.p-datatable .p-column-resizer-helper{width:1px;position:absolute;z-index:10;display:none}.p-datatable .p-row-editor-init,.p-datatable .p-row-editor-save,.p-datatable .p-row-editor-cancel,.p-datatable .p-row-toggler{display:inline-flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.p-datatable-reorder-indicator-up,.p-datatable-reorder-indicator-down{position:absolute}.p-datatable-reorderablerow-handle,[pReorderableColumn]{cursor:move}.p-datatable .p-datatable-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:3}.p-column-filter-row{display:flex;align-items:center;width:100%}.p-column-filter-menu{display:inline-flex}.p-column-filter-row p-columnfilterformelement{flex:1 1 auto;width:1%}.p-column-filter-menu-button,.p-column-filter-clear-button{display:inline-flex;justify-content:center;align-items:center;cursor:pointer;text-decoration:none;overflow:hidden;position:relative}.p-column-filter-overlay{position:absolute;top:0;left:0}.p-column-filter-row-items{margin:0;padding:0;list-style:none}.p-column-filter-row-item{cursor:pointer}.p-column-filter-add-button,.p-column-filter-remove-button{justify-content:center}.p-column-filter-add-button .p-button-label,.p-column-filter-remove-button .p-button-label{flex-grow:0}.p-column-filter-buttonbar{display:flex;align-items:center;justify-content:space-between}.p-column-filter-buttonbar .p-button{width:auto}.p-datatable-tbody>tr>td>.p-column-title{display:none}.p-datatable-scroller-spacer{display:flex}.p-datatable .p-scroller .p-scroller-loading{transform:none!important;min-height:0;position:sticky;top:0;left:0}}
</style>
<style>
@layer primeng{.p-paginator{display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.p-paginator-left-content{margin-right:auto}.p-paginator-right-content{margin-left:auto}.p-paginator-page,.p-paginator-next,.p-paginator-last,.p-paginator-first,.p-paginator-prev,.p-paginator-current{cursor:pointer;display:inline-flex;align-items:center;justify-content:center;line-height:1;-webkit-user-select:none;user-select:none;overflow:hidden;position:relative}.p-paginator-element:focus{z-index:1;position:relative}}
</style>
<style>
.dropdown-label[_ngcontent-ng-c1745413830]{font-family:Noto Sans,sans-serif;font-size:1rem}
</style>
<style>
@layer primeng{.p-dropdown{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-dropdown-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-dropdown-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-dropdown-label{display:block;white-space:nowrap;overflow:hidden;flex:1 1 auto;width:1%;text-overflow:ellipsis;cursor:pointer}.p-dropdown-label-empty{overflow:hidden;opacity:0}input.p-dropdown-label{cursor:default}.p-dropdown .p-dropdown-panel{min-width:100%}.p-dropdown-items-wrapper{overflow:auto}.p-dropdown-item{cursor:pointer;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-dropdown-item-group{cursor:auto}.p-dropdown-items{margin:0;padding:0;list-style-type:none}.p-dropdown-filter{width:100%}.p-dropdown-filter-container{position:relative}.p-dropdown-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-dropdown{display:flex}.p-fluid .p-dropdown .p-dropdown-label{width:1%}.p-float-label .p-dropdown .p-placeholder{opacity:0}}
</style>
<style>
@layer primeng{.p-overlay{position:absolute;top:0;left:0}.p-overlay-modal{display:flex;align-items:center;justify-content:center;position:fixed;top:0;left:0;width:100%;height:100%}.p-overlay-content{transform-origin:inherit}.p-overlay-modal>.p-overlay-content{z-index:1;width:90%}.p-overlay-top{align-items:flex-start}.p-overlay-top-start{align-items:flex-start;justify-content:flex-start}.p-overlay-top-end{align-items:flex-start;justify-content:flex-end}.p-overlay-bottom{align-items:flex-end}.p-overlay-bottom-start{align-items:flex-end;justify-content:flex-start}.p-overlay-bottom-end{align-items:flex-end;justify-content:flex-end}.p-overlay-left{justify-content:flex-start}.p-overlay-left-start{justify-content:flex-start;align-items:flex-start}.p-overlay-left-end{justify-content:flex-start;align-items:flex-end}.p-overlay-right{justify-content:flex-end}.p-overlay-right-start{justify-content:flex-end;align-items:flex-start}.p-overlay-right-end{justify-content:flex-end;align-items:flex-end}}
</style>
<style>
.material-icon-wysiwyg[_ngcontent-ng-c948301949]{font-size:18px;vertical-align:middle}.bg-planned[_ngcontent-ng-c948301949]{background-color:#cee5ff;color:#262928}.bg-inProgress[_ngcontent-ng-c948301949]{background-color:#f7c2f4;color:#262928}.bg-completed[_ngcontent-ng-c948301949]{background-color:#b3e7bd;color:#262928}.bg-delayed[_ngcontent-ng-c948301949]{background-color:#eda7a7;color:#262928}.bg-unknown[_ngcontent-ng-c948301949]{background-color:gray;color:#fff}.text-success[_ngcontent-ng-c948301949]{color:#1d8177!important}
    
table {
  border-collapse: collapse;
  width: 100%;
  border: 1px solid #ddd;
}

th, td {
  border: 1px solid #ddd;
  padding: 0px;
}

</style>
<!-- for left nav styles --> 

<!--style>
		#image-drop-upload-area {
			/*Sort of important*/
			width: 100%;
			/*Sort of important*/
			height: 75px;
			position:absolute;
			//border: 2px dashed rgba(0,0,0,.3);
			border-radius: 5px;
			font-family: Arial;
			text-align: left;
			position: relative;
			line-height: 55px;
			font-size: 17px;
			color: rgba(255,255,255);
			background-color: #515151;
			padding-left: 10%;
		}

		/*#image-drop-upload-area i {
			position: absolute;
			left: 23px
			line-height: 7px;
			font-size: 28px;
		}*/

		#image-drop-upload-area i {

			#image-drop-upload-area input {
				/*Important*/
				position: absolute;
				/*Important*/
				cursor: pointer;
				left: 0px;
				top: 0px;
				/*Important This is only comment out for demonstration purposes.*/
				opacity:0;
			}

			/*Important*/
			#image-drop-upload-area.mouse-over {
				border: 2px dashed rgba(0,0,0,.5);
				color: rgba(0,0,0,.5);
			}


		/*If you dont want the button*/
		#file-upload-btn {
			position: absolute;
			cursor: pointer;
			right: 2%;
			top: 27%;
			//margin-left: -50px;
			//margin-top: 20px;
			line-height: 26px;
			color: white;
			font-size: 15px;
			width: 140px;
			height: 37px;
			border-radius: 4px;
			background-color: #000000;
			border: 1px solid #adadad;
			text-align: center;
			line-height: 215%
		}

		#file-upload-btn:hover {
			background-color: #4499DD;

		}
   </style-->
</head>
<body id="body-pd" class="body-pd">
<upd-root _nghost-ng-c3392822675="" class="ng-tns-c3392822675-0" ng-version="18.2.2">
  <div _ngcontent-ng-c3392822675="" class="container vh-100 ng-tns-c3392822675-0">
    <upd-header _ngcontent-ng-c3392822675="" class="ng-tns-c3392822675-0" _nghost-ng-c3122493551="">
      <header _ngcontent-ng-c3122493551="" id="header">
        <div _ngcontent-ng-c3122493551="" class="row">
          <div _ngcontent-ng-c3122493551="" class="col-lg-3 col-md-4 col-sm-6 col-6 text-start"><img _ngcontent-ng-c3122493551="" width="834" height="76" priority="true" class="img-fluid fip-colour" alt="Government of Canada" loading="eager" fetchpriority="high" ng-img="true" src="img/CRA-FIP-9pt-e.png"></div>
          <div _ngcontent-ng-c3122493551="" class="col-lg-9 col-md-8 col-sm-6 col-6 text-end lang-toggle">
            <div _ngcontent-ng-c3122493551="" class="language-picker-area">
              <div _ngcontent-ng-c3122493551="" class="picker-label"></div>
              <a _ngcontent-ng-c3122493551="" tabindex="0" class="langs" style="cursor: pointer;"> Français </a> </div>
          </div>
        </div>
      </header>
    </upd-header>
    <upd-sidebar class="ng-tns-c3392822675-0">
      <div id="nav-bar" class="l-navbar show-n">
        <nav  class="nav">
          <div>
            <div class="nav_logo dropdown"> <a class="nav_logo_link" href="#"> <img alt="Project Assistant Logo" src="img/pa-logo.png"> <span class="dropdown-icon material-icons">arrow_drop_down</span> </a>
              <div class="dropdown-menu"> <a class="dropdown-item" href="https://cra-arc.alpha.canada.ca/en/overview/summary"> <span class="material-icons">leaderboard</span> UPD </a> <a class="dropdown-item" href="page-assistant.html"> <span class="material-icons">edit</span> Content Assistant </a> </div>
            </div>
            <!-- <a class="nav_logo" href=""><img alt="" src="img/ca-logo.png"></a> -->
            <div  class="nav_list mt-5"> <a id="active" class="nav_link active" href="inventory-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">layers</span><span data-i18n="menu-pages" class="nav_name">Inventory</span></a> <a class="nav_link" href="task-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">manage_search</span><span data-i18n="menu-tasks" class="nav_name">Newly published</span></a> <a class="nav_link" href="task-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">question_answer</span><span data-i18n="menu-tasks" class="nav_name">Top answers</span></a> <a class="nav_link" href="task-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">psychology</span><span data-i18n="menu-tasks" class="nav_name">Scenarios</span></a> <a class="nav_link" href="task-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">track_changes</span><span data-i18n="menu-tasks" class="nav_name">Synthesis</span></a> </div>
          </div>
          <div class="mb-4"> <a class="nav_link" href="about-us"><span aria-hidden="true" class="material-icons nav_icon">web_asset</span><span data-i18n="about-us" class="nav_name">About Us</span></a> <a class="nav_link" href="mailto:AIPIA-PIAAI@cra-arc.gc.ca?subject=Feedback for Content Assistant&amp;body="><span aria-hidden="true" class="material-icons nav_icon">feedback</span><span data-i18n="menu-feedback" class="nav_name">Feedback</span></a> </div>
        </nav>
      </div>
    </upd-sidebar>
    <genai-sidebar class="r-navbar expanded">
      <div class="toggle-btn" id="toggle-btn"> <i class="fa fa-angle-right"></i> </div>
      <div>
        <h3>GenAI reports</h3>
        <div id="genai-upload-msg">
          <p>Upload content to enable GenAI</p>
        </div>
        <fieldset id="genai-task-options" class="hidden">
          <legend>Select task</legend>
          <input type="checkbox" id="html-upload-genai-analysis-title" name="html-upload-genai-analysis" value="custom-instructions/metadata/title-en.txt">
          <label for="html-upload-genai-analysis-title">Suggest SEOed titles</label>
          <br>
          <input type="checkbox" id="html-upload-genai-analysis-description" name="html-upload-genai-analysis" value="custom-instructions/metadata/description-en.txt">
          <label for="html-upload-genai-analysis-description">Suggest metadata descriptions</label>
          <br>
          <input type="checkbox" id="html-upload-genai-analysis-keywords" name="html-upload-genai-analysis" value="custom-instructions/metadata/keywords-en.txt">
          <label for="html-upload-genai-analysis-keywords">Suggest metadata keywords</label>
          <br>
          <input type="checkbox" id="html-upload-genai-analysis-metadata" name="html-upload-genai-analysis" value="custom-instructions/metadata/metadata-review.txt">
          <label for="html-upload-genai-analysis-metadata">Metadata review</label>
          <br>
          <input type="checkbox" id="html-upload-genai-analysis-duplicate" name="html-upload-genai-analysis" value="custom-instructions/content/duplicate-review.txt">
          <label for="html-upload-genai-analysis-duplicate">Identify duplicate content</label>
          <br>
          
          <!--<input type="checkbox" id="genai-reports-title" name="genai-reports" value="Title">
                  <label for="genai-reports-title">Optimize title for search</label><br>
                  <input type="checkbox" id="genai-reports-validation" name="genai-reports" value="Validation">
                  <label for="genai-reports-validation">Validate accessibility</label><br>
                  <input type="checkbox" id="genai-reports-content" name="genai-reports" value="Content">
                  <label for="genai-reports-content">Simplify language</label><br>
                  <input type="checkbox" id="genai-reports-jargon" name="genai-reports" value="Jargon">
                  <label for="genai-reports-jargon">Identify jargon</label><br>
                  <input type="checkbox" id="genai-reports-structure" name="genai-reports" value="Structure">
                  <label for="genai-reports-structure">Improve structure</label><br>
                  <input type="checkbox" id="genai-reports-redundancies" name="genai-reports" value="Redundancies">
                  <label for="genai-reports-redundancies">Remove redundancies</label><br>
                  <input type="checkbox" id="genai-reports-metadata" name="genai-reports" value="Metadata">
                  <label for="genai-reports-metadata">Description and keywords</label><br>
                  <input type="checkbox" id="genai-reports-alt" name="genai-reports" value="Alt">
                  <label for="genai-reports-alt">Alt text for images</label><br>--> 
          <!-- Use any element to open/show the overlay navigation menu -->
          <button id="genai-select-tasks-btn" style="margin-top:15px;">Continue</button>
        </fieldset>
        <fieldset id="genai-model-options" class="hidden">
          <legend>Select model</legend>
          <input type="radio" id="html-upload-genai-model-gemini" name="html-upload-genai-model" value="google/gemini-2.0-flash-exp:free">
          <label for="html-upload-genai-model-gemini"> Gemini 2.0 Flash</label>
          <br>
          <input type="radio" id="html-upload-genai-model-llama" name="html-upload-genai-model" value="meta-llama/llama-3.2-90b-vision-instruct:free">
          <label for="html-upload-genai-model-llama"> Llama 3.2 90B</label>
          <br>
          <input type="radio" id="html-upload-genai-model-phi" name="html-upload-genai-model" value="microsoft/phi-3-medium-128k-instruct:free">
          <label for="html-upload-genai-model-phi"> Microsoft Phi-3 Medium</label>
          <br>
          <input type="radio" id="html-upload-genai-model-qwen" name="html-upload-genai-model" value="qwen/qwen-2-7b-instruct:free">
          <label for="html-upload-genai-model-qwen"> Qwen 2 7B</label>
          <br>
          <button id="genai-run-report-btn" style="margin-top:15px;">Run report</button>
        </fieldset>
        <div id="loading-indicator" class="hidden">
          <div class="spinner"></div>
          <p>Generating reports...</p>
        </div>
        <!--div id="genai-report-reset-options" class="hidden"-->
        <button id="genai-open-report-btn" style="margin-top:15px;" class="hidden">Open report</button>
        <br>
        <button id="genai-reset-report-btn" style="margin-top:15px;">Reset</button>
      </div>
    </genai-sidebar>
    <h1 _ngcontent-ng-c3392822675="" class="visually-hidden ng-tns-c3392822675-0">GPA | Inventory Assistant</h1>
    <main _ngcontent-ng-c3392822675="" style="min-height: 100%;" class="ng-tns-c3392822675-0 ng-trigger ng-trigger-routeAnimations">
      <router-outlet _ngcontent-ng-c3392822675="" class="ng-tns-c3392822675-0"></router-outlet>
      <upd-projects _nghost-ng-c947851115="" class="ng-star-inserted" style="">
        <router-outlet _ngcontent-ng-c947851115=""></router-outlet>
        <upd-projects-home _nghost-ng-c1826793033="" class="ng-star-inserted">
          <h2 _ngcontent-ng-c1826793033="">Inventory Assistant (Not yet functional)</h2>
          <upd-card _ngcontent-ng-c1826793033="" titlesize="h5">
            <div tabindex="0" class="card pt-2">
              <div class="card-body card-pad pt-2 h-100">
                <div class="justify-content-between"> 
                  
                  <!-- probably want to add some kind of reset button --> 
                  <!-- <button id="reset-btn" style="margin-bottom:20px;">Restart</button> -->
                  
                  <div id="api-key-entry">
                    <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">Enter the GenAI API key</h3>
                    <p>Before we start, add an openrouter API key to make your requests.</p>
                    <fieldset style="margin-bottom:20px;">
                      <legend>OpenRouter API key</legend>
                      <input id="api-key" type="text">
                      <p id="api-key-entry-error" class="error-msg hidden">Please enter a value for the API key. It can be a placeholder, but if so GenAI reports will not function.</p>
                      <button id="api-key-submit-btn" style="margin-top: 20px">Submit</button>
                    </fieldset>
                    <p>If you don't have one yet, here are some steps to create one:</p>
                    <ol>
                      <li>Create an account at <a href="https://www.openrouter.ai">openrouter.ai</a></li>
                      <li>Under the top right hamburger menu icon, select "Keys"</li>
                      <li>Create key (and save it somewhere!)
                        <ul>
                          <li>the point of this is to prevent abuse if you bought credits on your account if third parties find your key</li>
                          <li>you don't need to buy credits for free models used in this demo</li>
                          <li>you will be shown your key right after creating it: copy and save it somewhere, as you can't access it again through openrouter</li>
                          <li>if you want to try another model, or have credits on your account and want a paid model, let Miguel know so we can update the selections</li>
                        </ul>
                      </li>
                      <li>Now that you have a key, paste it in the input box above, which will use it for this session (the key is not sent back to us, so we won't see it!)</li>
                    </ol>
                  </div>
                  <div id="upload-chooser" class="after-key-unhide hidden"> 
                    <!--h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">Choose a genAI tool</h3--> 
                    <!-- Radio buttons for URL analysis, HTML snippet upload, image upload -->
                    <fieldset>
                      <legend>What do you would like to do?</legend>
                      <input type="radio" id="cop-inventory" name="action-option" value="cop-inventory" checked>
                      <label for="live">Create a COP inventory spreadsheet</label>
                      <br>
                      <input type="radio" id="genai-meta" name="action-option" value="genai-meta">
                      <label for="genai-meta">Generate Metadata</label>
                      <br>
                      <input type="radio" id="trans-meta" name="action-option" value="trans-meta">
                      <label for="trans-meta">Translate/localize metadata</label>
                      <br>
                      <input type="radio" id="create-word" name="action-option" value="create-word" checked>
                      <label for="create-word">Create Word documents (GitHub and Canada.ca)</label>
                      <br>
                      <input type="radio" id="rot-review" name="action-option" value="rot-review" checked>
                      <label for="rot-review">Do a ROT review (set of pages)</label>
                      <br>
                      <input type="radio" id="ia-diagram" name="action-option" value="ia-diagram" checked>
                      <label for="ia-diagram">Generate an IA diagram (set of pages)</label>
                      <br>
                      <input type="radio" id="apply-pattern" name="action-option" value="apply-pattern" checked>
                      <label for="apply-pattern">Apply an updated template/component/pattern</label>
                     <!-- <br>
                      <input type="radio" id="live" name="action-option" value="live" checked>
                      <label for="live">Live Canada.ca URLs</label>
                      <br>
                      <input type="radio" id="prototype" name="action-option" value="prototype">
                      <label for="prototype">Github prototype URLs</label>
                      <br>
                      <input type="radio" id="word" name="action-option" value="word">
                      <label for="word">Word docs (such as for French content)</label>
                      <br>-->
                      <!-- <input type="radio" id="image" name="upload-option" value="image">
                                      <label for="image">Image (for alt text; not yet available)</label><br> --> 
                      <!-- <button id="upload-chooser-btn">Continue</button> -->
                    </fieldset>
                  </div>
                  <div id="url-upload" class="after-key-unhide hidden">
                    <div id="url-upload-input" style="margin-top: 20px; margin-bottom:20px;">
                      <fieldset>
                        <legend>Enter the URLs in the project</legend>
                        <p class="small">Canada.ca is not yet supported. Use a github page!<br>
                          For example:<br>
                          https://cra-design.github.io/gst-hst-business/en/topics/gst-hst-businesses.html<br>
                        </p>
                        <div style="margin-top:10px; border:black solid 1px; min-height:75px;" > <span id="url-input" class="input" role="textbox" contenteditable></span> </div>
                        <!--legend style="margin-top:20px;">(Not yet implemented) Enter the equivalent page on Canada.ca</legend>
                                      <p class="small">This will help pull relevant analytics or feedback to enrich your GenAI recommendations</p>
                                      <input id="url-input-source" type="text"--> 
                        <br>
                        <button id="url-upload-btn" style="margin-top:40px;">Continue</button>
                      </fieldset>
                    </div>
                    <div id="url-upload-preview" class="hidden">
                      <upd-nav-tabs>
                        <div class="tabs sticky" style="z-index: 0 !important;">
                          <ul>
                            <li><a href="#" class="active" data-target="#table-init">Table</a></li>
                            <li><a href="#" data-target="#url-preview">Page</a></li>
                            <li><a href="#" data-target="#code-preview">Code</a></li>
                            <li><a href="#" data-target="#field-preview">Fields</a></li>
                            <li><a href="#" data-target="#data-tab">Data</a></li>
                          </ul>
                        </div>
                      </upd-nav-tabs>
                      <div id="table-init" class="tab-content">
                        <table>
                          <caption>
                          <strong>CAPTION: Information on URLs uploaded (Why are captions showing below tables?)</strong>
                          </caption>
                          <thead>
                            <tr>
                              <th>Link to page</th>
                              <th>Button</th>
                              <th>Description meta</th>
                              <th>Keywords meta</th>
                            </tr>
                          </thead>
                          <tbody>
                          </tbody>
                        </table>
                        <!-- Button to export table to Excel -->
                        <button id="export-excel-btn">Export to Excel</button>
                      </div>
                    </div>
                    <!--<div id="url-preview" class="tab-content"> --> 
                    
                    <!-- <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">
                                          Page preview
                                        </h3> --> 
                    <!-- This should theoretically allow for a page load, but Canada.ca has x-frame options set to deny, so it's being blocked - works for github for the moment though... Maybe there's a way on the AEM side to configure to specifically allow this tool to iframe pages? --> 
                    <!-- <div style="border:black solid 1px;" --> 
                    <!-- add some kind of tabbed interface with preview + code tabs? --> 
                    
                    <!-- <iframe id="url-frame" src="" name="targetframe" allowTransparency="true" width="100%" height="800px" style="border: 1px solid #ddd;"></iframe>--> 
                    <!--<p id="url-invalid-msg" class="error-msg hidden">The URL you input is invalid, please ensure it has proper syntax and try again.</p>
                        <p id="canada-ca-msg" class="error-msg hidden">Due to technical limitations, Canada.ca pages are not yet compatible with this tool. Try a Github URL to test it out!</p>
                        <p id="other-site-msg" class="error-msg hidden">The tool is only for validation of Canada.ca design work. If you believe this URL should be in scope, please reach out to the tool adminstrators to whitelist the domain.</p>--> 
                    <!-- </div> --> 
                    <!--</div>--> 
                    <!--<div id="code-preview" class="tab-content hidden"> --> 
                    <!-- <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">
                            Code preview
                        </h3> --> 
                    <!-- <pre id="fullHtml" class="language-markup" style="background: #f4f4f4; padding: 10px; border: 1px solid #ddd; white-space: pre-wrap;"><code></code></pre>
                      </div>--> 
                    <!-- <div id="field-preview" class="tab-content hidden"> --> 
                    <!-- <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">
                            Field preview
                        </h3> --> 
                    <!--<div id="fields"> <!--can put something around the parsed fields of the content - heading structure, metadata, etc--> 
                    <!--<table border="1">
                            <thead>
                              <tr>
                                <th>Field</th>
                                <th>Value</th>
                              </tr>
                            </thead>
                            <tbody id="extractedFields">
                            </tbody>
                          </table>
                        </div>
                      </div>
                      <div id="data-tab" class="tab-content hidden"> --> 
                    <!-- <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">
                                           Data context
                                         </h3> --> 
                    <!-- <p>Add data to these fields to help the AI give meaningful recommendations based on pain points it can identify. Once you complete these fields, rerun your genAI report.</p>
                        <p>Search terms</p>
                        <div id="search-terms-upload-inputbox" style="margin-top:10px; border:black solid 1px; min-height:75px;" > <span id="search-terms-input" class="input" role="textbox" contenteditable></span> </div>
                        <p style="margin-top:20px;">Page feedback summary</p>
                        <div id="feedback-summary-upload-inputbox" style="margin-top:10px; border:black solid 1px; min-height:75px;" > <span id="feedback-summary-input" class="input" role="textbox" contenteditable></span> </div>
                        <p style="margin-top:20px;">UX test findings (or heuristic commentary)</p>
                        <div id="heuristic-commentary-upload-inputbox" style="margin-top:10px; border:black solid 1px; min-height:75px;" > <span id="heuristic-commentary-input" class="input" role="textbox" contenteditable></span> </div>
                      </div>
                    </div>
                  </div> 
                  <div id="html-upload" class="hidden">
                    <div id="html-upload-input" style="margin-top:20px">
                      <fieldset>
                        <legend>Write or paste in your content or HTML to analyze</legend>
                        <div id="html-upload-inputbox" style="margin-top:10px; border:black solid 1px; min-height:75px;" > <span id="html-input" class="input" role="textbox" contenteditable></span> </div>
                      </fieldset>
                      <button id="html-upload-btn" style="margin-top: 20px">Submit</button>
                    </div>
                    <div id="html-upload-loading-spinner" class="hidden">
                      <div class="spinner"></div>
                      <p>Converting content to HTML...</p>
                    </div>--> 
                    <!-- <div id="html-upload-preview" class="hidden">
                  									<div id="html-upload-inputbox" style="margin-top:10px; border:black solid 1px; min-height:75px;" >
                  										<pre id="html-preview"></pre>
                  									</div>
                                  </div> --> 
                    <!--  <div id="html-upload-no-action-error" class="hidden">
                      <p>You must select an option for an action and model to run a report.</p>
                    </div>
                  </div>
                  <div id="word-upload" class="hidden">
                    <div id="word-upload-input" class="" style="margin-top:20px">
                      <fieldset>
                        <legend>Upload .docx word documents to generate HTML markup</legend>
                        <input type="file" id="word-file" name="word-file">--> 
                    <!--div id="image-drop-upload-area">
            															<i class="fas fa-upload"></i>
            															Drag and drop files here
            															<span id="file-upload-btn">Browse files
            																<input type="file" id="img-file" name="img-file">
            															</span>
            														</div>--> 
                    <!--    <input type="submit" id="word-upload-btn"> --> 
                    <!--Streamlit embed for alt text--> 
                    <!--  </fieldset> --> 
                    <!--div class="streamlit-container">
                                          <iframe
                                              src="https://imagealt-mwe2vpjxnnutmqf8docapm.streamlit.app/?embed=true"
                                              class="streamlit-embed"
                                              allow="camera;microphone"
                                              scrolling="yes">
                                          </iframe--> 
                    <!--  </div>
                  </div>
                  <div id="word-upload-preview" class="hidden" style="margin-top:20px;">
                    <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted"> Word document preview </h3>
                    <p id="word-invalid-msg" class="error-msg hidden">This feature currently only supports ".docx" files. .doc or other document file types are not compatible. Please try a .docx file or use the text input option to copy paste.</p>
                    <p id="word-multiple-msg" class="error-msg hidden">We currently only accept uploading word documents files individually. Try again with 1 word document.</p>
                    <div id="word-upload-loading-spinner" class="hidden">
                      <div class="spinner"></div>
                      <p>Converting word doc to HTML...</p>
                    </div> --> 
                    <!-- <div id="word-preview" class="hidden">
                                          <upd-nav-tabs>
                                            <div class="tabs sticky" style="z-index: 0 !important;">
                                              <ul>
                                                <li><a href="#" class="active" data-target="#word-render-preview"> Rendered preview</a></li>
                                                <li><a href="#" data-target="#word-code-preview"> Markup</a></li>
                                                <li><a href="#" data-target="#field-word-preview"> Fields</a></li>
                                              </ul>
                                            </div>
                                          </upd-nav-tabs>

                                          <div id="word-render-preview" class="tab-content">

                                            <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">
                                            Rendered HTML preview
                                            </h3>
                                            <iframe id="word-preview-iframe" style="width: 100%; height: 800px; border: 1px solid #ddd;"></iframe>
                                          </div>

                                          <div id="word-code-preview" class="tab-content hidden">

                                            <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">
                                            HTML markup preview
                                            </h3>
                                            <pre id="word-html-code" class="language-markup" style="background: #f4f4f4; padding: 10px; border: 1px solid #ddd; white-space: pre-wrap;"><code></code></pre>
                                          </div>
                                      </div> --> 
                    
                    <!--  </div>
                  <div id="image-upload" class="hidden">
                    <div id="image-upload-input" class="" style="margin-top:20px">
                      <fieldset>
                        <legend>Upload images or PDFs to create image alt text</legend>
                        <input type="file" id="img-file" name="img-file"> --> 
                    <!--div id="image-drop-upload-area">
              															<i class="fas fa-upload"></i>
              															Drag and drop files here
              															<span id="file-upload-btn">Browse files
              																<input type="file" id="img-file" name="img-file">
              															</span>
              														</div--> 
                    <!--    <input type="submit" id="img-upload-btn"> --> 
                    <!--Streamlit embed for alt text--> 
                    <!--   </fieldset> --> 
                    <!--div class="streamlit-container">
                                            <iframe
                                                src="https://imagealt-mwe2vpjxnnutmqf8docapm.streamlit.app/?embed=true"
                                                class="streamlit-embed"
                                                allow="camera;microphone"
                                                scrolling="yes">
                                            </iframe--> 
                    <!--  </div>
                  </div>
                  <div id="image-upload-preview" class="hidden" style="margin-top:20px;">
                    <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted"> Image preview </h3>
                    <img alt="" id="image-preview" />
                    <p id="image-invalid-msg" class="hidden">The image you uploaded isn't in a recognized format. Please try a JPG or PNG. If you think the image format should be accepted, please reach out to the administrator.</p>
                    <p id="image-multiple-msg" class="hidden">We currently only accept uploading image files individually. Try again with 1 image.</p>
                  </div>
                </div>
                <upd-card-secondary-title _nghost-ng-c334178256=""> 
                </upd-card-secondary-title>--> 
                  </div>
                </div>
              </div>
            </div>
          </upd-card>
        </upd-projects-home>
      </upd-projects>
      
      <!-- Creating the right-hand nav --> 
    </main>
  </div>
</upd-root>
<footer _ngcontent-ng-c3392822675="" class="mt-4 ng-tns-c3392822675-0">
  <div _ngcontent-ng-c3392822675="" class="d-flex justify-content-between align-items-end mt-auto pb-4 ng-tns-c3392822675-0">
    <div _ngcontent-ng-c3392822675="" class="align-self-end ng-tns-c3392822675-0"><span _ngcontent-ng-c3392822675="" class="text-muted small ng-tns-c3392822675-0">version: 0.0.1 </span></div>
    <div _ngcontent-ng-c3392822675="" class="col-lg-2 col-md-3 col-sm-4 col-4 ng-tns-c3392822675-0"><img _ngcontent-ng-c3392822675="" class="img-fluid ng-tns-c3392822675-0" alt="Government of Canada" src="img/canada-black-30mm.png"></div>
  </div>
</footer>
<!-- expanded genai nav -->
<div id="genai-nav" class="overlay"> 
  
  <!-- Button to close the overlay navigation --> 
  <a href="javascript:void(0)" class="closebtn" id="close-report-btn">&times;</a>
  <div class="overlay-content">
    <h3>GenAI reports</h3>
    <div id="accessibility-report" class="hidden">
      <h4>Accessibility validation summary</h4>
    </div>
    <div id="metadata-report" class="hidden">
      <h4>Metadata recommendations</h4>
      <p><strong>Description:</strong> <span id="report-genai-description-output"></span></p>
      <p><strong>Keywords:</strong> <span id="report-genai-keywords-output"></span></p>
    </div>
    <div id="content-report" class="hidden">
      <h4>Content recommendations</h4>
      <p><strong>Conversational rewrite:</strong> <span id="report-genai-conversational-output"></span></p>
      <p><strong>Shortened rewrite:</strong> <span id="report-genai-trim-output"></span></p>
    </div>
  </div>
</div>

<!-- <link rel="modulepreload" href="chunk-UUN4AIJG.js">
      <link rel="modulepreload" href="chunk-GGWSDF3Q.js">
      <link rel="modulepreload" href="chunk-ODN5LVDJ.js"> --> 
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script> 
<script src="js/beautify.js"></script> 
<script src="js/mammoth.js"></script> 
<script src="https://www.canada.ca/etc/designs/canada/wet-boew/js/theme.min.js"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/html-docx-js/dist/html-docx.min.js"></script> 
<script src="js/prism.js"></script> 
<!-- <script src="polyfills-VMRJL7IV.js" type="module"></script><script src="main-BEEWNT6W.js" type="module"></script> --> 
<!--<script type="text/javascript">
          $(document).ready(function() {

			/*
			//$(function () {
				var dropZoneId = "image-drop-upload-area";
				var buttonId = "file-upload-btn";
				var mouseOverClass = "mouse-over";

				var dropZone = $("#" + dropZoneId);
				var ooleft = dropZone.offset().left;
				var ooright = dropZone.outerWidth() + ooleft;
				var ootop = dropZone.offset().top;
				var oobottom = dropZone.outerHeight() + ootop;
				var inputFile = dropZone.find("input");
				document.getElementById(dropZoneId).addEventListener("dragover", function (e) {
					e.preventDefault();
					e.stopPropagation();
					dropZone.addClass(mouseOverClass);
					var x = e.pageX;
					var y = e.pageY;

					if (!(x < ooleft || x > ooright || y < ootop || y > oobottom)) {
						inputFile.offset({ top: y - 15, left: x - 100 });
					} else {
						inputFile.offset({ top: -400, left: -400 });
					}

				}, true);

				if (buttonId != "") {
					var clickZone = $("#" + buttonId);

					var oleft = clickZone.offset().left;
					var oright = clickZone.outerWidth() + oleft;
					var otop = clickZone.offset().top;
					var obottom = clickZone.outerHeight() + otop;

					$("#" + buttonId).mousemove(function (e) {
						var x = e.pageX;
						var y = e.pageY;
						if (!(x < oleft || x > oright || y < otop || y > obottom)) {
							inputFile.offset({ top: y - 15, left: x - 160 });
						} else {
							inputFile.offset({ top: -400, left: -400 });
						}
					});
				}

				document.getElementById(dropZoneId).addEventListener("drop", function (e) {
					$("#" + dropZoneId).removeClass(mouseOverClass);
				}, true);

			//})
			*/

            $("#reset-btn").click(function(){
              resetHiddenUploadOptions();
              $('#api-key-entry').removeClass("hidden");
              $('#upload-chooser').addClass("hidden");
            });

            $("#api-key-submit-btn").click(function(){
              //validate the key to see if it's legit?

              $('#api-key-entry').addClass("hidden");
              $('#upload-chooser').removeClass("hidden");
              $('#url-upload').removeClass("hidden");
            });

            $(document).on("click", "input[type=radio]", function (event) {
              var target = event.target;
              // var parts = target.name.split("-");
              // var locationNumber = parts[parts.length - 1];
              if (target.name == "upload-option") {
                //Check which radio button it is and which content it's show/hiding
                resetHiddenUploadOptions();
                if (target.id == "live") {
                  $('#url-upload').removeClass("hidden");
                  $('#url-upload-input').removeClass("hidden");
                } else if (target.id == "prototype") {
                  $('#url-upload').removeClass("hidden");
                  $('#url-upload-input').removeClass("hidden");
                } else if (target.id == "word") {
                  $('#word-upload').removeClass("hidden");
                  $('#word-upload-input').removeClass("hidden");
                }
              }
            });

            $("#url-upload-btn").click(function(){
              $('#upload-chooser').addClass("hidden");
              $('#url-upload-input').addClass("hidden");
              $('#url-upload-preview').removeClass("hidden");
              $("#url-frame").addClass("hidden"); //reset iframe hidden
              $("#url-invalid-msg").addClass("hidden");
              $("#canada-ca-msg").addClass("hidden");
              $("#other-site-msg").addClass("hidden");
              //load the iframe with the html preview
              var bUrlInput = isValidUrl($('#url-input').val());
              if (bUrlInput == false) { //invalid url
                //unhide URL invalid message
                $("#url-invalid-msg").removeClass("hidden");
                $('#url-upload-input').removeClass("hidden");
                return;
              }
              const urlInput = new URL($('#url-input').val());
              // Currently configuring it to specific github organizations:
              if (urlInput.host == "cra-design.github.io" || urlInput.host == "gc-proto.github.io" || urlInput.host == "test.canada.ca" || urlInput.host == "cra-proto.github.io") { //github links
                $("#url-frame").attr("src", urlInput.href);
                $("#url-frame").removeClass("hidden");
                $("#genai-upload-msg").addClass("hidden");
                $("#genai-task-options").removeClass("hidden");
                parsePageHTML(urlInput.href, function (err, html) {
                    if (err) {
                        console.error('Failed to fetch the webpage:', err);
                        alert('Failed to fetch the webpage. Check the console for details.');
                        return;
                    }
                    // Extract fields from the HTML
                    const fields = extractFields(html);
                    // Render results to the page
                    renderHTMLFields(html, fields);
                });
              } else if (urlInput.host == "www.canada.ca") { //canada.ca link


                //Maybe we can implement a iframe render of the HTML code for the canada.ca pages?



                //unhide Canada.ca not yet supported message
                $("#canada-ca-msg").removeClass("hidden");
                $('#url-upload-input').removeClass("hidden");
              } else { //unsupported site
                //unhide unsupported site message
                $("#other-site-msg").removeClass("hidden");
                $('#url-upload-input').removeClass("hidden");
              }
              //do we also want a tab to view the code? Maybe this is where we can make edits or changes with GenAI, then reload in the iframe? Could we do this with some html manipulation in the javascript of the already-loaded iframe? Or would we need to rebuild the page in the script?
            });

            $("#html-upload-btn").click(function() {
              // $("#html-preview").html($("#html-input").html());
              // $("#html-upload-preview").removeClass("hidden");
              $("#html-upload-loading-spinner").removeClass("hidden");
              let extractedHtml = convertTextToHTML($("#html-input").html());
              RefineSyntax(extractedHtml);
            });


      			$(document).on("change", "input", async function (event) {
      				if (event.target.id == "img-file") {
      					$("#image-invalid-msg").addClass("hidden");
      					$("#image-multiple-msg").addClass("hidden");
      					var fileList = event.target.files;
      					if (fileList.length > 0 && fileList != undefined) {
      						if (fileList.length > 1) { //uploaded more than 1 picture - could perhaps support this in the future
      							$("#image-multiple-msg").removeClass("hidden");
      						} else if (fileList[0].type.substring(0,5) != "image") {
      							$("#image-invalid-msg").removeClass("hidden");
      						} else {
      							//Preview the image
      							$("#image-preview").attr("src", URL.createObjectURL(fileList[0]));
      							$("#image-upload-preview").removeClass("hidden");
      						}
      					}
      				} else if (event.target.id == "word-file") {
                $("#word-upload-preview").removeClass("hidden");
                $("#word-upload-loading-spinner").removeClass("hidden");
      					$("#word-invalid-msg").addClass("hidden");
      					$("#word-multiple-msg").addClass("hidden");

      					var fileList = event.target.files;
                if (!fileList || fileList.length === 0) return;
                if (fileList.length > 1) {
                    $("#word-multiple-msg").removeClass("hidden");
                    $("#word-upload-loading-spinner").addClass("hidden");
                    return;
                }
                var wordFile = fileList[0];
                var validMimeType = "application/vnd.openxmlformats-officedocument.wordprocessingml.document";
                var fileExtension = wordFile.name.split('.').pop().toLowerCase();
                if (wordFile.type !== validMimeType || fileExtension !== 'docx') {
                    $("#word-invalid-msg").removeClass("hidden");
                    $("#word-upload-loading-spinner").addClass("hidden");
                    return;
                }
                var reader = new FileReader();
                reader.onload = async function (event) {
                    var arrayBuffer = reader.result;
                    try {
                        // Extract raw text with Mammoth.js
                        let result = await mammoth.convertToHtml({ arrayBuffer: arrayBuffer });
                        let extractedHtml = result.value.trim();
                        if (!extractedHtml) {
                            $("#word-invalid-msg").removeClass("hidden").text("The document is empty or could not be read.");
                            $("#word-upload-loading-spinner").addClass("hidden");
                            return;
                        }
                        RefineSyntax(extractedHtml);
                    } catch (err) {
                        console.error("Error extracting text:", err);
                        $("#word-invalid-msg").removeClass("hidden").text("Failed to parse document.");
                        $("#word-upload-loading-spinner").addClass("hidden");
                        return;
                    }
                };
                reader.readAsArrayBuffer(wordFile);
      				}
            });

            $("#genai-select-tasks-btn").click(function () {
              $("#genai-task-options").addClass("hidden");
              $("#genai-model-options").removeClass("hidden");
            });

            $("#genai-run-report-btn").click(async function () {
      				$("#genai-model-options").addClass("hidden");
      				$("#genai-open-report-btn").addClass("hidden"); // Hide report button initially
      				$("#loading-indicator").removeClass("hidden"); // Show spinner
      				//$("#genai-report-reset-options").removeClass("hidden");
      				let selectedTasks = [];
      				let model = $('input[name="html-upload-genai-model"]:checked').val();
      				let systemGeneral = { role: "system", content: "You are an expert web editor. Analyze the provided web page content according to the guidelines in the following system prompt to provide actionable recommendations in plain text. Never include code or HTML in your response. The contextual data may include search terms, user feedback or ux test findings to help you understand the pain points or user behaviour your recommendations should address." }
      				let systemTask = { role: "system", content: "" }
      				let userContent = { role: "user", content: "Web page content: "}
      				let userData = { role: "user", content: "Contextual data: " }
      				let reportContainer = $(".overlay-content");
      				reportContainer.find(".generated-report").remove();


      				//triage which content to feed to the AI for analysis if free content input
      				// if ($('#html-upload-preview').is(':visible')) {
      					// userContent.content += $("#html-input").html();
      				// } else if ($('#url-upload-preview').is(':visible')) {
      					userContent.content += $("#fullHtml").text(); //give it the full page html
      					userData.content += "Search terms: " + $("#search-terms-input").text(); //give it any data we have
      					userData.content += "Page feedback summary: " + $("#feedback-summary-input").text();
      					userData.content += "Heuristic commentary: " + $("#heuristic-commentary-input").text();
      				// }

      				//Gather selected tasks
      				$('input[name="html-upload-genai-analysis"]:checked').each(function () {
      					selectedTasks.push({
      						id: $(this).attr('id'),
      						value: $(this).val()
      					});
      				});

      				//Process each selected task asynchronously
      				if (selectedTasks.length > 0) {
                  for (const task of selectedTasks) {
                    try {
          						let fileContent = await $.get(task.value);
          						systemTask.content = "Custom instruction: " + fileContent;
          						// Create the JSON with the prompt and instructions
          						let requestJson = [systemGeneral, systemTask, userContent, userData];

          						// Send it to the API
          						let ORjson = await getORData(model, requestJson);
          						let aiResponse = ORjson.choices[0].message.content;
          						let formattedText = formatAIResponse(aiResponse);
          						//console.log(formattedText);

          						// Find the corresponding label text
          						let labelText = $(`label[for='${task.id}']`).text().trim();

          						// Create new report section dynamically
          						let newReport = $(
          							'<div class="generated-report">' +
          								'<h4>' + labelText + '</h4>' +
          								'<p>' + formattedText + '</p>' +
          							'</div>'
          						);
          						// Append to the report container
          						reportContainer.append(newReport);
          						$("#genai-open-report-btn").removeClass("hidden"); // Show report button
                    } catch (error) {
                        console.error(`Error generating report:`, error);
                        // $("#html-upload-preview").addClass("hidden");
                        $("#html-upload-no-action-error").removeClass("hidden");
                    }
                  }
          		} else {
          			// $("#html-upload-preview").addClass("hidden");
          			$("#html-upload-no-action-error").removeClass("hidden");
          		}

      				/*var htmlObject = ;
      				if (.length < 1 || fileList == undefined) {
      					$("#html-invalid-msg").removeClass("hidden");
      				}
      				$("#image-preview").attr("data-src", URL.createObjectURL(htmlObject));
      				$("#image-upload-preview").removeClass("hidden");
      				*/
              $("#loading-indicator").addClass("hidden"); // Hide spinner when done
            });


            $("#genai-open-report-btn").click(function(){
              /* Open when someone clicks on the span element */
              //function openNav() {
                document.getElementById("genai-nav").style.width = "100%";
              //}
            });

            $("#genai-reset-report-btn").click(function(){
              $("#genai-model-options").addClass("hidden");
              $("#genai-task-options").removeClass("hidden");
              $('input[name="html-upload-genai-analysis"]').prop('checked', false);
              $('input[name="html-upload-genai-model"]').prop('checked', false);
            });
            $("#close-report-btn").click(function(){
              /* Open when someone clicks on the span element */
                document.getElementById("genai-nav").style.width = "0%";
            });

            //tab interface - page/code preview for urls

            $('.tabs ul li a').on('click', function (e) {
              e.preventDefault();
              $('.tabs ul li a').removeClass('active');
              $(this).addClass('active');
              $('.tab-content').addClass('hidden');
              const target = $(this).data('target');
              $(target).removeClass('hidden');

            });

          }); //close document ready

          function resetHiddenUploadOptions() {
            $('#url-upload').addClass("hidden");
            $('#url-upload-input').addClass("hidden");
            $('#url-upload-preview').addClass("hidden");
            $('#html-upload').addClass("hidden");
            $('#html-upload-input').addClass("hidden");
            // $('#html-upload-preview').addClass("hidden");
            $("#html-upload-no-action-error").addClass("hidden");
            $('#image-upload').addClass("hidden");
            $('#image-upload-input').addClass("hidden");
            $('#image-upload-preview').addClass("hidden");
            $('#word-upload').addClass("hidden");
            $('#word-upload-input').addClass("hidden");
            $('#word-upload-preview').addClass("hidden");
            $("#genai-upload-msg").removeClass("hidden");
            $("#genai-task-options").addClass("hidden");
            $('input[name="html-upload-genai-analysis"]').prop('checked', false);
            $('input[name="html-upload-genai-model"]').prop('checked', false);
          }

          async function getORData(model, requestJson) {
              let ORjson;
              console.log(JSON.stringify({
                  "model": model,
                  "messages": requestJson
              }));
              try {
                  const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                      method: "POST",
                      headers: {
                          "Authorization": "Bearer " + $("#api-key").val(),
                          "Content-Type": "application/json"
                      },
                      body: JSON.stringify({
                          "model": model,
                          "messages": requestJson
                      })
                  });

                  if (!response.ok) {
                      throw new Error(`Response status: ${response.status}`);
                  }
                  ORjson = await response.json();

              } catch (error) {
                  console.error("Error fetching from OpenRouter API:", error.message);
                  return undefined;
              }
            return ORjson;
          }

          const isValidUrl = urlString=> {
              try {
                  return Boolean(new URL(urlString));
              }
              catch(e){
                  return false;
              }
          }

          function parsePageHTML(url, callback) {
              $.ajax({
                  url: url,
                  method: 'GET',
                  success: function (response) {
                      callback(null, response);
                  },
                  error: function (err) {
                      callback(err);
                  }
              });
          }

          // Function to extract fields from the HTML
          function extractFields(html) {

              const $html = $('<div>').append(html); // Wrap in a parent container

              //const metaTags = $html.find('meta'); // Now `.find()` will catch everything
              //console.log(metaTags);

              // const $html = $(html);
              // console.log($html);
              //
              // const metaTags = $html.find('meta');
              // console.log(metaTags);

              // Extract specific fields
              const h1 = $html.find('h1').first().text().trim() || 'Not Found';
              const metaKeywords = $html.find('meta[name="keywords"]').attr('content') || 'Not Found';
              const metaDescriptionTag = $html.find("meta[name='description']");
              const metaDescription = metaDescriptionTag.length && metaDescriptionTag.attr('content')
                  ? metaDescriptionTag.attr('content').trim()
                  : 'Not Found';
              // Extract the first <p> after the <h1>
              const introParagraph = $html.find('h1').first().nextAll('p').first().text().trim() || 'Not Found';
              // Extract full body content
              // Extract "doormats" sections into an array
              const doormats = [];
              $html.find('.gc-srvinfo section').each(function () {
                  const $section = $(this);
                  const link = $section.find('h3 a').attr('href') || 'No link';
                  const title = $section.find('h3 a').text().trim() || 'No title';
                  const description = $section.find('p').text().trim() || 'No description';
                  doormats.push({ link, title, description });
              });
      			  // Assign "Not Found" if no doormats were extracted
      			  const doormatsResult = doormats.length > 0 ? doormats : 'Not Found';
              // Extract all tables as an array
              const tables = [];
              $html.find('table').each(function () {
                  const tableHTML = $(this).prop('outerHTML');
                  tables.push(tableHTML ? tableHTML.trim() : 'Not Found');
              });
      			  // Assign "Not Found" if no tables were extracted
      			  const tablesResult = tables.length > 0 ? tables : 'Not Found';
              // Extract full body content
              const bodyContentRaw = $html.find('body').html(); // Untrimmed content
              const bodyContent = bodyContentRaw ? bodyContentRaw.trim() : 'Not Found'; // Trimmed content


              // Return extracted fields
              return {
                  h1,
                  metaDescription,
                  metaKeywords,
                  // introParagraph,
                  // doormats: doormatsResult,
                  // tables: tablesResult,
                  // bodyContent,
              };
          }

          function formatAIResponse(aiResponse) {
          	return aiResponse
          		.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>") // Bold (**text** → <strong>text</strong>)
          		.replace(/\*(.*?)\*/g, "<em>$1</em>") // Italics (*text* → <em>text</em>)
          		.replace(/\n\s*-\s*(.*?)(?=\n|$)/g, "<li>$1</li>") // Convert "- item" to list items
          		.replace(/(<li>.*<\/li>)/g, "<ul>$1</ul>") // Wrap list items in <ul>
          		.split("\n") // Split by line breaks
          		.filter(line => line.trim() !== "") // Remove empty lines
          		.map(line => `<p>${line}</p>`) // Wrap remaining text in <p> tags
          		.join(""); // Join everything back together
          }

          // Function to render the full HTML and extracted fields
          function renderHTMLFields(fullHtml, fields) {
              // Display the full HTML in the <pre> tag
              $('#fullHtml code').text(fullHtml);
              Prism.highlightElement(document.querySelector("#fullHtml code"));

              // Display the extracted fields in the table
              const $tableBody = $('#extractedFields');
              $tableBody.empty(); // Clear any previous data

              Object.keys(fields).forEach(field => {
                  $tableBody.append(`
                      <tr>
                          <td>${field}</td>
                          <td>${fields[field]}</td>
                      </tr>
                  `);
              });
          }

          function formatHTML(htmlString) {
              // Create a new DOMParser instance
              const parser = new DOMParser();
              // Parse the HTML string into a Document
              const doc = parser.parseFromString(htmlString, 'text/html');
              // Serialize the Document back to a string with indentation
              const formattedHTML = doc.documentElement.outerHTML;
              // Return the formatted HTML
              return formattedHTML;
          }

          function convertTextToHTML(text) {
              // Split the text into paragraphs based on double newlines
              const paragraphs = text.split(/\n\s*\n/);

              // Wrap each paragraph with <p> tags and replace single newlines with <br>
              const htmlParagraphs = paragraphs.map(paragraph => {
                  const escapedParagraph = paragraph
                      .replace(/&/g, '&amp;')
                      .replace(/</g, '&lt;')

                      .replace(/>/g, '&gt;')
                      .replace(/"/g, '&quot;')
                      .replace(/'/g, '&#39;');
                  const withLineBreaks = escapedParagraph.replace(/\n/g, '<br>');
                  return `<p>${withLineBreaks}</p>`;
              });

              // Join all paragraphs into a single string
              return htmlParagraphs.join('');
          }

          async function RefineSyntax(extractedHtml) {
            // Define the HTML header and footer
            let htmlHeader = `
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Preview</title>
                    <link href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" rel="stylesheet">
                </head>
                <body>
                    <main>
            `;
            let htmlFooter = `
                    </main>
                </body>
                </html>
            `;
            let systemWord = { role: "system", content: "You are an expert in converting plain text into structured, semantic HTML. Only respond with html documents, never with explanations or plain text." }
            let userWord = { role: "user", content: 'Clean up the following conversion from text into HTML ensuring it has good, clean syntax with proper headings, paragraphs, and lists where applicable: ' + htmlHeader + extractedHtml + htmlFooter }
            // Create the JSON with the prompt and instructions
            let requestJson = [systemWord, userWord];
            // Send it to the API
            let ORjson = await getORData("google/gemini-2.0-flash-exp:free", requestJson);
            let aiWordResponse = ORjson.choices[0].message.content.trim();
            // Remove leading and trailing backticks
            let newHeader = `
              <link rel="stylesheet" href="https://www.canada.ca/etc/designs/canada/wet-boew/css/wet-boew.min.css"/>
              <link rel="stylesheet" href="https://www.canada.ca/etc/designs/canada/wet-boew/css/theme.css"/>
              <link href="https://test.canada.ca/covid-19-guidance/proto/css/alpha-beta-banner.css" rel="stylesheet">
              <body vocab="http://schema.org/" typeof="WebPage" resource="#wb-webpage">
              <nav>
                <ul id="wb-tphp">
                 <li class="wb-slc"><a class="wb-sl" href="#wb-cont">Skip to main content</a></li>
                 <li class="wb-slc visible-sm visible-md visible-lg"><a class="wb-sl" href="#wb-info">Skip to &#34;About this site&#34;</a></li>
                </ul>
              </nav>
              <header>
                 <div id="wb-bnr" class="container">
                  <div class="row">
                      <section id="wb-lng" class="col-xs-3 col-sm-12 pull-right text-right">
                          <h2 class="wb-inv">Language selection</h2>
                          <ul class="list-inline mrgn-bttm-0">
                              <li>
                                  <a lang="fr" hreflang="fr" href="https://www.canada.ca/fr/agence-revenu/services/a-propos-agence-revenu-canada-arc/plaintes-differends/dispositions-allegement-contribuables.html">
                                    <span class="hidden-xs">Français</span>
                                    <abbr title="Français" class="visible-xs h3 mrgn-tp-sm mrgn-bttm-0 text-uppercase">fr</abbr>
                                  </a>
                              </li>
                          </ul>
                      </section>
                      <div class="brand col-xs-9 col-sm-5 col-md-4" property="publisher" typeof="GovernmentOrganization">
                          <a href="https://www.canada.ca/en.html" property="URL">
                            <img src="https://www.canada.ca/etc/designs/canada/wet-boew/assets/sig-blk-en.svg" alt="Government of Canada" property="logo">
                            <span class="wb-inv"> /
                                <span lang="fr">Gouvernement du Canada</span>
                            </span>
                          </a>
                          <meta property="name" content="Government of Canada">
                          <meta property="areaServed" typeof="Country" content="Canada">
                          <link property="logo" href="https://www.canada.ca/etc/designs/canada/wet-boew/assets/wmms-blk.svg">
                      </div>
                      <section id="wb-srch" class="col-lg-offset-4 col-md-offset-4 col-sm-offset-2 col-xs-12 col-sm-5 col-md-4">
                          <h2>Search</h2>
                          <form action="https://www.canada.ca/en/revenue-agency/search.html" method="get" name="cse-search-box" role="search">
                            <div class="form-group wb-srch-qry">
                                <label for="wb-srch-q" class="wb-inv">Search Canada.ca</label>
                                <input name="cdn" value="canada" type="hidden"/>
                                <input name="st" value="s" type="hidden"/>
                                <input name="num" value="10" type="hidden"/>
                                <input name="langs" value="en" type="hidden"/>
                                <input name="st1rt" value="1" type="hidden"/>
                                <input name="s5bm3ts21rch" value="x" type="hidden"/>
                                <input id="wb-srch-q" list="wb-srch-q-ac" class="wb-srch-q form-control" name="q" type="search" value="" size="34" maxlength="170" placeholder="Search CRA"/>
                                <datalist id="wb-srch-q-ac"></datalist>
                            </div>
                            <div class="form-group submit">
                                <button type="submit" id="wb-srch-sub" class="btn btn-primary btn-small" name="wb-srch-sub">
                                    <span class="glyphicon-search glyphicon"></span>
                                    <span class="wb-inv">Search</span></button>
                            </div>
                          </form>
                      </section>
                    </div>
                  </div><hr/>
                  <div class="container"><div class="row">
                    <div class="col-md-8">
                      <nav class="gcweb-menu" typeof="SiteNavigationElement">
                        <h2 class="wb-inv">Menu</h2>
                        <button type="button" aria-haspopup="true" aria-expanded="false"><span class="wb-inv">Main </span>Menu <span class="expicon glyphicon glyphicon-chevron-down"></span></button>
                        <ul role="menu" aria-orientation="vertical" data-ajax-replace="/content/dam/canada/sitemenu/sitemenu-v2-en.html">
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/jobs.html">Jobs and the workplace</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/immigration-citizenship.html">Immigration and citizenship</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://travel.gc.ca/">Travel and tourism</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/business.html">Business and industry</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/benefits.html">Benefits</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/health.html">Health</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/taxes.html">Taxes</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/environment.html">Environment and natural resources</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/defence.html">National security and defence</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/culture.html">Culture, history and sport</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/policing.html">Policing, justice and emergencies</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/transport.html">Transport and infrastructure</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="http://international.gc.ca/world-monde/index.aspx?lang=eng">Canada and the world</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/finance.html">Money and finances</a></li>
                          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.canada.ca/en/services/science.html">Science and innovation</a></li>
                        </ul>
                      </nav>
                    </div>
                    <div class="col-xs-5 col-xs-offset-7 col-md-offset-0 col-md-4"><section id="wb-so"><h2 class="wb-inv">Sign in</h2><a class="btn btn-primary" href="https://www.canada.ca/en/revenue-agency/services/e-services/cra-login-services.html"><span class="visible-xs">Sign in</span><span class="hidden-xs">CRA sign in</span></a></section></div></div></div>
                    <nav id="wb-bc" property="breadcrumb"><h2 class="wb-inv">You are here:</h2><div class="container"><ol class="breadcrumb">
                      <li><a href='https://www.canada.ca/en.html'>Canada.ca</a></li>
                      <li><a href='https://www.canada.ca/en/revenue-agency.html'>Canada Revenue Agency</a></li>
                      </ol></div>
                    </nav>
                    <main property="mainContentOfPage" resource="#wb-main" typeof="WebPageElement">
                    <div class="container">
            `;
            let newFooter = `</div>
                <div class="container">
                 <div class="pagedetails">
                  <h2 class="wb-inv">Page details</h2>
                  <div class="row">
                   <div class="col-sm-8 col-md-9 col-lg-9">
                    <div class="wb-disable-allow" data-ajax-replace="https://www.canada.ca/etc/designs/canada/wet-boew/assets/feedback/page-feedback-en.html" data-feedback-section="Section" data-feedback-theme="Theme">
                    </div>
                   </div>
                  </div>
                 </div>
                </div>
                <div class="container pagedetails">
                  <dl id="wb-dtmd">
                    <dt>Date modified:</dt>
                    <dd>
                      <time property="dateModified">2020-07-29</time>
                    </dd>
                  </dl>
                </div>
              </main>
              <footer>
               <section id="wb-info">
                <h2 class="wb-inv">About this site</h2>
                  <div class="gc-contextual">
                    <div class="container">
                      <nav>
                        <h3>Canada Revenue Agency (CRA)</h3>
                        <ul class="list-col-xs-1 list-col-sm-2 list-col-md-3"><li><a href="https://www.canada.ca/en/revenue-agency/corporate/contact-information.html">Contact the CRA</a></li><li><a href="https://www.canada.ca/en/revenue-agency/services/update-information-cra.html">Update your information</a></li><li><a href="https://www.canada.ca/en/revenue-agency/corporate/about-canada-revenue-agency-cra.html">About the CRA</a></li></ul>
                      </nav>
                    </div>
                  </div>
                  <div class="gc-main-footer">
                    <div class="container">
                      <nav>
                        <h3>Government of Canada</h3>
                        <ul class="list-col-xs-1 list-col-sm-2 list-col-md-3">
                          <li><a href="https://www.canada.ca/en/contact.html">All contacts</a></li>
                          <li><a href="https://www.canada.ca/en/government/dept.html">Departments and agencies</a></li>
                          <li><a href="https://www.canada.ca/en/government/system.html">About government</a></li>
                        </ul>
                        <h4><span class="wb-inv">Themes and topics</span></h4>
                        <ul class="list-unstyled colcount-sm-2 colcount-md-3"><li><a href="https://www.canada.ca/en/services/jobs.html">Jobs</a></li>
                          <li><a href="https://www.canada.ca/en/services/immigration-citizenship.html">Immigration and citizenship</a></li>
                          <li><a href="https://travel.gc.ca/">Travel and tourism</a></li>
                          <li><a href="https://www.canada.ca/en/services/business.html">Business</a></li>
                          <li><a href="https://www.canada.ca/en/services/benefits.html">Benefits</a></li>
                          <li><a href="https://www.canada.ca/en/services/health.html">Health</a></li>
                          <li><a href="https://www.canada.ca/en/services/taxes.html">Taxes</a></li>
                          <li><a href="https://www.canada.ca/en/services/environment.html">Environment and natural resources</a></li>
                          <li><a href="https://www.canada.ca/en/services/defence.html">National security and defence</a></li>
                          <li><a href="https://www.canada.ca/en/services/culture.html">Culture, history and sport</a></li>
                          <li><a href="https://www.canada.ca/en/services/policing.html">Policing, justice and emergencies</a></li>
                          <li><a href="https://www.canada.ca/en/services/transport.html">Transport and infrastructure</a></li>
                          <li><a href="https://www.international.gc.ca/world-monde/index.aspx?lang=eng">Canada and the world</a></li>
                          <li><a href="https://www.canada.ca/en/services/finance.html">Money and finance</a></li>
                          <li><a href="https://www.canada.ca/en/services/science.html">Science and innovation</a></li>
                          <li><a href="https://www.canada.ca/en/services/indigenous-peoples.html">Indigenous peoples</a></li>
                          <li><a href="https://www.canada.ca/en/services/veterans.html">Veterans and military</a></li>
                          <li><a href="https://www.canada.ca/en/services/youth.html">Youth</a></li></ul>
                      </nav>
                    </div>
                  </div>
                  <div class="gc-sub-footer">
                    <div class="container d-flex align-items-center">
                      <nav>
                        <h3 class="wb-inv">Government of Canada Corporate</h3>
                        <ul>
                          <li><a href="https://www.canada.ca/en/social.html">Social media</a></li>
                          <li><a href="https://www.canada.ca/en/mobile.html">Mobile applications</a></li>
                          <li><a href="https://www.canada.ca/en/government/about.html">About Canada.ca</a></li>
                          <li><a href="https://www.canada.ca/en/transparency/terms.html">Terms and conditions</a></li>
                          <li><a href="https://www.canada.ca/en/revenue-agency/corporate/privacy-notice.html">Privacy</a></li>
                        </ul>
                      </nav>
                      <div class="wtrmrk align-self-end">
                        <img src="https://wet-boew.github.io/themes-dist/GCWeb/GCWeb/assets/wmms-blk.svg" alt="Symbol of the Government of Canada"/>
                      </div>
                    </div>
                  </div>
                </section>
              </footer>
            `;
            let trimmedHtml = aiWordResponse.replace(/^```|```$/g, '');
            trimmedHtml = trimmedHtml.replace(/^html/, '');
            trimmedHtml = trimmedHtml.replace('<main>', newHeader);
            trimmedHtml = trimmedHtml.replace('</main>', newFooter);
            trimmedHtml = trimmedHtml.replace('<h1>', '<h1 property="name" id="wb-cont" dir="ltr">');
            const formattedHTML = formatHTML(trimmedHtml);
            // Insert the processed HTML into the iframe
            let iframe = document.getElementById("url-frame");
            if (iframe) {
              let iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
              iframeDoc.open();
              iframeDoc.write(trimmedHtml);
              iframeDoc.close();
            } else {
              console.error("Iframe with id 'url-frame' not found.");
            }
            // Show the raw HTML markup in the code tab
            $("#fullHtml code").text(formattedHTML);
            // Apply syntax highlighting
            Prism.highlightElement(document.querySelector("#fullHtml code"));
            $("#html-upload").addClass("hidden");
            $("#html-upload-loading-spinner").addClass("hidden");
            $("#word-upload-loading-spinner").addClass("hidden");
            $("#upload-chooser").addClass("hidden");
            $("#word-upload").addClass("hidden");
            $("#word-upload-preview").addClass("hidden");

            $("#url-upload").removeClass("hidden");
            $("#url-upload-preview").removeClass("hidden");
            $("#genai-upload-msg").addClass("hidden");
            $("#genai-task-options").removeClass("hidden");
          }
      </script> --> 
<script src="js/content-assistant.js"></script> 
<script src="js/inventory-assistant.js"></script>
</body>
</html>
