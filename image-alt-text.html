<!DOCTYPE html>
<html lang="en-CA" data-critters-container="">
   <head>
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <!-- !! CHANGE TITLE !! -->
      <title>Image Alt Text Assistant | Content Assistant</title>
      <!--base href="./"-->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="icon" type="image/x-icon" href="img/favicon-ca.ico">
      <meta name="robots" content="noindex, nofollow">
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous">
	   <!-- Include existing styles -->
      <link rel="stylesheet" href="css/UPD-styles.css" media="all" onload="this.media='all'">
      <link rel="stylesheet" href="css/ca-styles.css" media="all" onload="this.media='all'">
	   <link rel="stylesheet" href="css/prism.css" data-noprefix />
      <noscript>
         <link rel="stylesheet" href="css/UPD-styles.css">
         <link rel="stylesheet" href="css/ca-styles.css">
      </noscript>
      <!-- Add specific styles for this tool if needed -->
      <style>
         /* Add styles matching the python app if desired, e.g., for columns */
         .result-container {
             border: 1px solid #ddd;
             padding: 15px;
             margin-bottom: 20px;
             border-radius: 5px;
         }
         .result-columns {
             display: flex;
             gap: 20px;
             margin-top: 10px;
         }
         .result-column {
             flex: 1;
         }
         .result-image {
             max-width: 100%;
             height: auto;
             margin-bottom: 10px;
         }
         .copy-button {
             background-color:#4CAF50;
             border:none;
             color:white;
             padding: 8px 15px; /* Smaller padding */
             text-align:center;
             text-decoration:none;
             display:inline-block;
             font-size: 14px; /* Smaller font */
             margin-top: 5px; /* Spacing */
             cursor:pointer;
             border-radius:4px;
         }
         .copy-button:hover {
             background-color: #45a049;
         }
         #progress-area {
             margin-top: 15px;
         }
         .spinner { /* Basic spinner */
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 10px;
         }
         @keyframes spin {
             0% { transform: rotate(0deg); }
             100% { transform: rotate(360deg); }
         }
         /* Inherited spinner styles might also apply */

        /* Hide canvas used for PDF rendering */
        #pdf-canvas {
            display: none;
         }
         
         /* Styles for formatted PDF descriptions */
         .formatted-description {
             max-height: 400px;
             overflow-y: auto;
             padding: 10px;
             background-color: #f9f9f9;
             border: 1px solid #eee;
             border-radius: 4px;
             margin-bottom: 10px;
         }
         
         .formatted-description p {
             margin-bottom: 0.8em;
         }
         
         .formatted-description ul, .formatted-description ol {
             padding-left: 20px;
             margin-bottom: 0.8em;
         }
         
         .formatted-description h4 {
             margin-top: 1em;
             margin-bottom: 0.5em;
             font-size: 1.1em;
             font-weight: bold;
         }
         
         /* Styles for collapsible sections */
         .collapsible-container {
             position: relative;
             margin-bottom: 10px;
         }
         
         .preview-text {
             background-color: #f9f9f9;
             padding: 10px;
             border-radius: 4px;
             border: 1px solid #eee;
             margin-bottom: 5px;
         }
         
         .toggle-button {
             background-color: #f0f0f0;
             border: 1px solid #ddd;
             padding: 5px 10px;
             border-radius: 4px;
             cursor: pointer;
             margin-bottom: 5px;
             font-size: 14px;
         }
         
         .toggle-button:hover {
             background-color: #e0e0e0;
         }
      </style>
   </head>
   <body id="body-pd" class="body-pd">
      <upd-root _nghost-ng-c3392822675="" class="ng-tns-c3392822675-0" ng-version="18.2.2">
         <div _ngcontent-ng-c3392822675="" class="container vh-100 ng-tns-c3392822675-0">
            <!-- Header (Copied from page-assistant.html) -->
            <upd-header _ngcontent-ng-c3392822675="" class="ng-tns-c3392822675-0" _nghost-ng-c3122493551="">
               <header _ngcontent-ng-c3122493551="" id="header">
                  <div _ngcontent-ng-c3122493551="" class="row">
                     <div _ngcontent-ng-c3122493551="" class="col-lg-3 col-md-4 col-sm-6 col-6 text-start"><img _ngcontent-ng-c3122493551="" width="834" height="76" priority="true" class="img-fluid fip-colour" alt="Government of Canada" loading="eager" fetchpriority="high" ng-img="true" src="img/CRA-FIP-9pt-e.png"></div>
                     <div _ngcontent-ng-c3122493551="" class="col-lg-9 col-md-8 col-sm-6 col-6 text-end lang-toggle">
                        <div _ngcontent-ng-c3122493551="" class="language-picker-area">
                           <div _ngcontent-ng-c3122493551="" class="picker-label"></div>
                           <a _ngcontent-ng-c3122493551="" tabindex="0" class="langs" style="cursor: pointer;"> Fran√ßais </a>
                        </div>
                     </div>
                  </div>
               </header>
            </upd-header>

            <!-- Sidebar (Copied from page-assistant.html) -->
            <upd-sidebar class="ng-tns-c3392822675-0">
               <div id="nav-bar" class="l-navbar show-n">
                 <nav  class="nav">
                     <div>
                       <div class="nav_logo dropdown">
                         <a class="nav_logo_link" href="#">
                            <img alt="Content Assistant Logo" src="img/ca-logo.png">
                            <span class="dropdown-icon material-icons">arrow_drop_down</span>
                         </a>
                         <div class="dropdown-menu">
                            <a class="dropdown-item" href="https://cra-arc.alpha.canada.ca/en/overview/summary">
                               <span class="material-icons">leaderboard</span> UPD
                            </a>
                            <a class="dropdown-item" href="inventory-assistant.html">
                               <span class="material-icons">fact_check</span> Project Assistant
                            </a>
                         </div>
                      </div>
                        <div  class="nav_list mt-5">
                           <a class="nav_link" href="page-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">article</span><span class="nav_name">Pages</span></a>
                           <!-- !! MAKE THIS LINK ACTIVE !! -->
                           <a id="active" class="nav_link active" href="image-alt-text.html"><span aria-hidden="true" class="material-icons nav_icon">image</span><span class="nav_name">Images</span></a>
                           <a class="nav_link" href="translation-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">language</span><span class="nav_name">Translations</span></a>
                           <a class="nav_link" href="wording-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">spellcheck</span><span class="nav_name">Wording</span></a>
                           <a class="nav_link" href="wizard-assistant.html"><span aria-hidden="true" class="material-icons nav_icon">fork_left</span><span class="nav_name">Wizards</span></a>
                        </div>
                     </div>
                     <div class="mb-4">
                       <a class="nav_link" href="about-us"><span aria-hidden="true" class="material-icons nav_icon">web_asset</span><span class="nav_name">About Us</span></a>
                       <a class="nav_link" href="mailto:AIPIA-PIAAI@cra-arc.gc.ca?subject=Feedback%20for%20Content%20Assistant&body="><span aria-hidden="true" class="material-icons nav_icon">feedback</span><span class="nav_name">Feedback</span></a>
                     </div>
                  </nav>
               </div>
            </upd-sidebar>

            <!-- No GenAI Sidebar for this tool (unless desired later) -->

            <!-- Main Content Area -->
            <main _ngcontent-ng-c3392822675="" style="min-height: 100%;" class="ng-tns-c3392822675-0 ng-trigger ng-trigger-routeAnimations">
               <router-outlet _ngcontent-ng-c3392822675="" class="ng-tns-c3392822675-0"></router-outlet>
               <!-- Using simpler structure than Angular components -->
               <div class="ng-star-inserted">
                  <!-- !! CHANGE HEADING !! -->
                  <h2>Image Alt Text Assistant</h2>
                  <p>Upload images (PNG, JPG) or PDFs to create image alt text with French translations for use on Canada.ca</p>

                  <upd-card titlesize="h5">
                     <div tabindex="0" class="card pt-2">
                        <div class="card-body card-pad pt-2 h-100">
                           <div class="justify-content-between">

                              <!-- API Key Entry (Copied from page-assistant.html) -->
                              <div id="api-key-entry">
                                 <h3 class="card-title h5 modal-icon-alignment pb-2 ng-star-inserted">Enter the GenAI API key</h3>
                                 <p>Before we start, add an openrouter API key to make your requests.</p>
                                 <fieldset style="margin-bottom:20px;">
                                    <legend>OpenRouter API key</legend>
                                    <!-- Hidden input to store key from URL -->
                                    <input id="api-key" type="hidden">
                                    <!-- Display/Input for user -->
                                    <input id="api-key-display" type="text"></span>
                                    <p id="api-key-entry-error" class="error-msg hidden">Please enter a value for the API key.</p>
                                    <button id="api-key-submit-btn" style="margin-top: 20px">Submit</button>
                                 </fieldset>
                                 <p>If you don't have one yet, refer to the steps on the Page Assistant tool or visit <a href="https://www.openrouter.ai" target="_blank">openrouter.ai</a>.</p>
                              </div>

                              <!-- Main Tool Area (Hidden until key is submitted) -->
                              <div id="tool-area" class="after-key-unhide hidden">
                                 <div style="margin-bottom: 20px;">
                                    <label for="vision-model-select">Choose Vision Model:</label>
                                    <select id="vision-model-select" class="form-control" style="display: inline-block; width: auto; margin-left: 10px;">
                                       <option value="google/gemini-pro-vision" selected>google/gemini-pro-vision</option>
                                       <!-- Note: Llama 3.2 Vision might not be free tier or consistently available on OpenRouter -->
                                       <option value="meta-llama/llama-3.2-11b-vision-instruct">meta-llama/llama-3.2-11b-vision-instruct</option>
                                       <!-- Qwen model -->
                                       <option value="qwen/qwen2.5-vl-32b-instruct:free">qwen/qwen2.5-vl-32b-instruct:free</option>
                                       <!-- Add other compatible models if available on OpenRouter -->
                                    </select>
                                 </div>

                                 <fieldset>
                                     <legend>Choose image or PDF files</legend>
                                     <input type="file" id="file-uploader" name="files" multiple accept=".png,.jpg,.jpeg,.pdf">
                                 </fieldset>

                                 <div id="progress-area" style="margin-top: 20px;" class="hidden">
                                    <div class="spinner"></div>
                                    <span id="progress-text">Processing...</span>
                                    <progress id="progress-bar" value="0" max="100" style="width: 100%;"></progress>
                                 </div>

                                 <div id="results-display" style="margin-top: 30px;">
                                    <!-- Results will be appended here -->
                                 </div>

                                 <div id="csv-download-area" style="margin-top: 30px;">
                                    <!-- CSV Download link will appear here -->
                                 </div>
                              </div>

                           </div>
                        </div>
                     </div>
                  </upd-card>
               </div>
               <!-- Hidden canvas for PDF rendering and image resizing -->
               <canvas id="pdf-canvas"></canvas>
            </main>

            <!-- Footer (Copied from page-assistant.html) -->
            <footer _ngcontent-ng-c3392822675="" class="mt-4 ng-tns-c3392822675-0">
               <div _ngcontent-ng-c3392822675="" class="d-flex justify-content-between align-items-end mt-auto pb-4 ng-tns-c3392822675-0">
                  <div _ngcontent-ng-c3392822675="" class="align-self-end ng-tns-c3392822675-0"><span _ngcontent-ng-c3392822675="" class="text-muted small ng-tns-c3392822675-0">version: 0.0.1 </span></div>
                  <div _ngcontent-ng-c3392822675="" class="col-lg-2 col-md-3 col-sm-4 col-4 ng-tns-c3392822675-0"><img _ngcontent-ng-c3392822675="" class="img-fluid ng-tns-c3392822675-0" alt="Government of Canada" src="img/canada-black-30mm.png"></div>
               </div>
            </footer>
         </div>
      </upd-root>

      <!-- Scripts -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> <!-- Updated jQuery -->
      <!-- Include PDF.js library files -->
      <!-- Download from https://mozilla.github.io/pdf.js/getting_started/#download -->
      <!-- Place pdf.mjs and pdf.worker.mjs in your js/pdfjs/ directory -->
      <script src="js/pdfjs/pdf.mjs" type="module"></script>

      <!-- Beautify JS (already included) -->
      <script src="js/beautify.js"></script>
      <!-- Canada.ca Theme JS (already included) -->
      <!-- <script src="https://www.canada.ca/etc/designs/canada/wet-boew/js/theme.min.js"></script> -->
      <!-- Prism JS (already included) -->
      <script src="js/prism.js"></script>
      <!-- Common Assistant JS (Handles API Key URL Param) -->
      <script src="js/image-alt.js"></script>
      <!-- !! NEW JS FILE FOR THIS TOOL !! -->
      <script src="js/image-alt-text.js" type="module"></script> <!-- Use type="module" for PDF.js imports -->

   </body>
</html>
